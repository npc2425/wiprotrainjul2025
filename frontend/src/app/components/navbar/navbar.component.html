<header class="navbar">
  <div class="navbar-content">
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" (click)="toggleMobileMenu()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"/>
        <line x1="3" y1="12" x2="21" y2="12"/>
        <line x1="3" y1="18" x2="21" y2="18"/>
      </svg>
    </button>

    <!-- Brand Section -->
    <div class="brand-section" (click)="navigateHome()">
      <div class="brand-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
        </svg>
      </div>
      <h1 class="brand-title">Luxe</h1>
    </div>

    <!-- Desktop Navigation -->
    <div class="search-container">
      <div class="search-wrapper">
        <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <path d="m21 21-4.35-4.35"/>
        </svg>
        <input
          type="text"
          placeholder="Search products..."
          class="search-input"
          [value]="searchQuery()"
          (input)="onSearchInput($event)"
          (keyup.enter)="onSearchSubmit()"
        />
        <div *ngIf="isSearching()" class="search-loading">
          <div class="search-spinner"></div>
        </div>
      </div>

      <!-- Search Results Dropdown -->
      <div class="search-results" *ngIf="showSearchResults() && searchResults().length > 0">
        <div class="search-results-header">
          <span>Products</span>
          <button class="view-all-btn" (click)="onSearchSubmit()">View All</button>
        </div>
        <div class="search-results-list">
          <div 
            *ngFor="let product of searchResults().slice(0, 5)" 
            class="search-result-item"
            (click)="onSearchResultClick(product)"
          >
            <img [src]="product.imageURL" [alt]="product.prodName" class="result-image">
            <div class="result-content">
              <h4 class="result-title">{{ product.prodName }}</h4>
              <p class="result-category">{{ product.prodCat }}</p>
              <span class="result-price">â‚¹{{ product.price }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Header Actions -->
    <div class="header-actions">
      <!-- Cart Button -->
      <button class="action-btn cart-btn" (click)="toggleCart()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="8" cy="21" r="1"/>
          <circle cx="19" cy="21" r="1"/>
          <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
        </svg>
        <span class="cart-badge" *ngIf="cartCount() > 0">{{ cartCount() }}</span>
      </button>

      <!-- User Section -->
      <div *ngIf="isLoggedIn()" class="profile-section">
        <div class="profile-trigger" (click)="toggleProfileMenu()">
          <div class="avatar">
            <span>{{ getUserInitials() }}</span>
          </div>
          <div class="profile-info">
            <span class="user-name">{{ currentUser()?.firstName }} {{ currentUser()?.lastName }}</span>
            <span class="user-role">{{ isAdmin() ? 'Administrator' : 'Customer' }}</span>
          </div>
          <svg class="chevron" [class.rotated]="showProfileMenu()" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 12,15 18,9"/>
          </svg>
        </div>

        <!-- Profile Menu -->
        <div class="profile-menu" [class.active]="showProfileMenu()">
          <a *ngIf="isAdmin()" class="menu-item" routerLink="/dashboard" (click)="showProfileMenu.set(false)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <line x1="9" y1="9" x2="15" y2="9"/>
              <line x1="9" y1="15" x2="15" y2="15"/>
            </svg>
            Dashboard
          </a>
          <a class="menu-item" routerLink="/profile" (click)="showProfileMenu.set(false)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </svg>
            Profile
          </a>
          <a class="menu-item" routerLink="/orders" (click)="showProfileMenu.set(false)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
            </svg>
            Orders
          </a>
          <div class="menu-divider"></div>
          <button class="menu-item logout-btn" (click)="logout()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
              <polyline points="16,17 21,12 16,7"/>
              <line x1="21" y1="12" x2="9" y2="12"/>
            </svg>
            Sign Out
          </button>
        </div>
      </div>

      <!-- Guest Actions -->
      <div *ngIf="!isLoggedIn()" class="guest-actions">
        <button class="action-btn login-btn" (click)="navigateToLogin()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
            <polyline points="10,17 15,12 10,7"/>
            <line x1="15" y1="12" x2="3" y2="12"/>
          </svg>
          <span class="btn-text">Sign In</span>
        </button>
        <button class="action-btn register-btn" (click)="navigateToRegister()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="8.5" cy="7" r="4"/>
            <line x1="20" y1="8" x2="20" y2="14"/>
            <line x1="23" y1="11" x2="17" y2="11"/>
          </svg>
          <span class="btn-text">Register</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div class="mobile-menu" [class.active]="showMobileMenu()">
    <nav class="mobile-nav">
    

      <div class="mobile-divider"></div>
      
      <div *ngIf="isLoggedIn()" class="mobile-user-section">
        <div class="mobile-user-info">
          <div class="mobile-avatar">
            <span>{{ getUserInitials() }}</span>
          </div>
          <div>
            <div class="mobile-user-name">{{ currentUser()?.firstName }} {{ currentUser()?.lastName }}</div>
            <div class="mobile-user-role">{{ isAdmin() ? 'Administrator' : 'Customer' }}</div>
          </div>
        </div>
        
        <a *ngIf="isAdmin()" routerLink="/dashboard" class="mobile-nav-link" (click)="showMobileMenu.set(false)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <line x1="9" y1="9" x2="15" y2="9"/>
            <line x1="9" y1="15" x2="15" y2="15"/>
          </svg>
          Dashboard
        </a>
        <a routerLink="/profile" class="mobile-nav-link" (click)="showMobileMenu.set(false)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
            <circle cx="12" cy="7" r="4"/>
          </svg>
          Profile
        </a>
        <a routerLink="/orders" class="mobile-nav-link" (click)="showMobileMenu.set(false)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
          </svg>
          Orders
        </a>
        <button class="mobile-nav-link logout-btn" (click)="logout(); showMobileMenu.set(false)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            <polyline points="16,17 21,12 16,7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
          Sign Out
        </button>
      </div>
      
      <div *ngIf="!isLoggedIn()" class="mobile-auth-section">
        <button class="mobile-auth-btn login" (click)="navigateToLogin(); showMobileMenu.set(false)">Sign In</button>
        <button class="mobile-auth-btn register" (click)="navigateToRegister(); showMobileMenu.set(false)">Register</button>
      </div>
    </nav>
  </div>
</header>
